<div class="bg-white rounded-[16px] m-[16px] height-table">
  <div *ngIf="showFirst">
    <div class="flex justify-between items-center px-5 py-[16px]">
      <div class="flex flex-col items-start">
        <h1
          class="text-black font-bold leading-[28px] text-fieldskhoa font-chu2 text-[22px]"
        >
          {{ title }}
        </h1>
        <span
          class="font-medium text-[14px] leading-[22px] text-[#687588] font-chu2 mt-[8px]"
          >Quản lý Tổ chức Hoạt động ngoại khoá</span
        >
      </div>
    </div>
    <div class="flex px-[20px] py-[8px] items-center justify-end w-full">
      <div class="relative w-full">
        <div
          class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"
        >
          <i class="ph-bold ph-magnifying-glass text-[20px]"></i>
        </div>
        <input
          type="text"
          [(ngModel)]="searchText"
          name="timDDs"
          class="block w-full h-[44px] p-2 pl-10 text-sm border-[#EBEAED] rounded-[10px] text-chung"
          placeholder="Tìm Kiếm"
          required
        />
      </div>

      <div class="flex gap-4 ml-[16px]">
        <div>
          <button
            class="text-black whitespace-nowrap max-w-[150px] truncate p-2 h-[44px] hover:border-[#29B475] focus:outline-none border-[1px] rounded-[10px] text-[14px] font-medium font-chu2 px-4 py-2.5 text-center inline-flex items-center"
            type="button"
          >
            Tên Hoạt Động
            <i class="ph-bold ph-caret-down text-[15px] pl-[5px]"></i>
          </button>

          <!-- Dropdown menu -->
          <div
            *ngIf="showDropdow"
            class="z-10 absolute bg-white divide-y w-[130px] divide-gray-100 rounded-lg shadow dark:bg-gray-700 h-[200px] overflow-y-auto"
          >
            <ul
              class="py-2 text-sm text-gray-700 dark:text-gray-200"
              aria-labelledby="filtertenbh"
            >
              <!-- (click)="resetFilterNK()" -->
              <li>
                <a
                  class="block px-4 py-2 hover:bg-gray-100 font-chu2 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer"
                >
                  Tất Cả Tên
                </a>
              </li>
              <!-- <li
                    *ngFor="let lop of quanLyLopData | uniqueFilter : 'tenBh'"
                    value="tenBh"
                  >
                    <a
                      (click)="filterNam(lop.tenBh)"
                      class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer font-chu2"
                    >
                      {{ lop.tenBh }}
                    </a>
                  </li> -->
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="overflow-y-auto h-[67.7vh] rounded-[16px] m-[16px]">
      <table class="w-full font-[Manrope] text-chung tables">
        <thead class="font-bold bg-[#FAFAFA] text-[#687588] sticky">
          <tr>
            <th class="text-center pl-[10px] ths">
              <button class="flex items-center gap-4 pl-[15px]">
                Hoạt động
                <div class="pt-1">
                  <i class="ph-bold ph-arrow-fat-up"></i>
                  <!-- <i  class="ph-bold ph-arrow-fat-down"></i> -->
                </div>
              </button>
            </th>
            <th class="ten ths">
              <button class="flex items-center gap-4">
                Địa điểm
                <div class="pt-1">
                  <i class="ph-bold ph-arrow-fat-up"></i>
                  <!-- <i *ngIf="!this.isIcons" class="ph-bold ph-arrow-fat-down"></i> -->
                </div>
              </button>
            </th>
            <th class="ten ths">
              <button class="flex items-center gap-4">
                Ngày Bắt Đầu
                <div class="pt-1">
                  <i class="ph-bold ph-arrow-fat-up"></i>
                  <!-- <i *ngIf="!this.isIcons" class="ph-bold ph-arrow-fat-down"></i> -->
                </div>
              </button>
            </th>
            <th class="ten ths">
              <button class="flex items-center gap-4">
                Ngày Kết Thúc
                <div class="pt-1">
                  <i class="ph-bold ph-arrow-fat-up"></i>
                  <!-- <i *ngIf="!this.isIcons" class="ph-bold ph-arrow-fat-down"></i> -->
                </div>
              </button>
            </th>
            <th class="ten ths">
              <button class="flex items-center gap-4">
                CVHT
                <div class="pt-1">
                  <i class="ph-bold ph-arrow-fat-up"></i>
                  <!-- <i *ngIf="!this.isIcons" class="ph-bold ph-arrow-fat-down"></i> -->
                </div>
              </button>
            </th>
            <th class="text-center w-[140px] ths">Tuỳ Chọn</th>
          </tr>
        </thead>

        <tbody class="text-center font-normal" *ngIf="!loading">
          <tr
            *ngFor="
              let diemdanh of dataDiemDanh
                | search : searchText
                | paginate : { itemsPerPage: 15, currentPage: p }
            "
          >
            <td
              class="ten max-w-[200px] pl-[22px] truncate hover:text-[#29B475] hover:underline cursor-pointer tds"
            >
              {{ diemdanh.tenHdnk }}
            </td>
            <td class="ten tds">
              {{ diemdanh.tenDiaDiem !== null ? diemdanh.tenDiaDiem : "Trống" }}
            </td>
            <td class="ten pr-[10px] pl-[10px] max-w-[200px] truncate tds">
              {{ diemdanh.ngayBd | date : "dd/MM/yyyy" }}
            </td>
            <td class="ten tds">{{ diemdanh.ngayKt | date : "dd/MM/yyyy" }}</td>
            <td class="ten tds">
              {{
                diemdanh.tenGiangVien !== null ? diemdanh.tenGiangVien : "Trống"
              }}
            </td>
            <td class="text-center tds">
              <div class="flex justify-center gap-[10px]">
                <button
                  (click)="editSV(diemdanh)"
                  class="hover:scale-110 transition-transform border-[1px] bg-[#27A376] rounded-[8px]"
                >
                  <i class="ph ph-eye text-white p-[6px] text-[17px]"></i>
                </button>
                <!-- (click)="onDelete(lop.idbh)" -->
                <!-- <button
                  class="hover:scale-110 transition-transform border-[1px] border-[#EDF2F7] rounded-[8px]"
                >
                  <i
                    class="ph-bold ph-trash text-[#E0221F] p-[8px] text-[14px]"
                  ></i>
                </button> -->
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <ngx-skeleton-loader
        *ngIf="loading"
        count="98"
        [theme]="{
          width: '130px',
          height: '30px',
          left: '20px',
          margin: '10px',
          'border-radius': '10px',
          background: '#F5F5F5'
        }"
        appearance="line"
      ></ngx-skeleton-loader>

      <div
        *ngIf="
          !loading &&
          dataDiemDanh &&
          (dataDiemDanh | search : searchText).length === 0
        "
        class="flex flex-col items-center font-chu2 pt-[32px]"
      >
        <img src="../../../../assets/empty1.png" class="w-[87px] h-[87px]" />

        <h1 class="text-[#718096] text-[18px] font-bold pt-[16px]">
          Dữ liệu trống
        </h1>
        <p class="text-[14px] font-normal text-[#A0AEC0]">
          Vui lòng nhập dữ liệu lên hệ thống
        </p>
      </div>
      <div class="flex justify-between pt-[16px] py-[10px] relative">
        <div>
          <button
            *ngIf="showDeleteAllButton"
            class="flex p-3 text-btn h-[35px] justify-center items-center gap-[8px] button-addkhoa bg-red-600 hover:bg-red-400 text-white font-chu2 transition-all cursor-pointer"
          >
            Xoá Tất Cả
          </button>
        </div>

        <div
          class="flex justify-end items-center font-chu2"
          *ngIf="
            dataDiemDanh?.length > 15 &&
            (dataDiemDanh | search : searchText)?.length > 15
          "
        >
          <h1 class="text-[12px] text-fields pb-4">
            Showing 1 to 15 of
            {{ dataDiemDanh ? dataDiemDanh.length : 0 }} entries
          </h1>
          <pagination-controls
            class="text-[12px]"
            (pageChange)="p = $event"
          ></pagination-controls>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- diemdanh -->
<div class="px-[24px] pt-[8px]">
  <div *ngIf="showCheckin">
    <div class="flex items-center" *ngIf="editingSV">
      <button (click)="clickCloseCheck()">
        <i
          class="ph-bold ph-caret-left text-[20px] pr-[8px] text-[#A0AEC0]"
        ></i>
      </button>
      <h1 class="text-[20px] font-bold">{{ editingSV.tenHdnk }}</h1>
    </div>
    <div class="flex gap-[24px] pt-[24px]">
      <div class="bg-white rounded-[16px] p-[16px] max-h-[620px]">
        <h3 class="text-[20px] font-bold text-center">Điểm Danh</h3>
        <div class="h-[1px] bg-[#F1F2F4] my-[24px]"></div>
        <div class="bg-[#F7FAFC] p-[8px] rounded-[10px] mb-[24px]">
          <div class="flex justify-center">
            <i class="ph-bold ph-timer text-[24px]"></i>
          </div>
          <div class="flex justify-center">
            <h4 class="text-[14px] font-medium">
              Thời gian quét mã còn lại {{ formatTime(remainingTime) }}
            </h4>
          </div>
        </div>
        <div
          class="w-[200px] h-[200px] pl-[20px] mb-[24px]"
          *ngIf="!showCamera"
        >
          <div>
            <img
              src="../../../../assets/qr.jpg"
              class="absolute w-[199px] h-[199px] rounded-xl"
            />
            <div class="square">
              <div class="scan">
                <div class="w-[full] h-[4px] bg-[#29B475]"></div>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="showCamera">
          <div class="my-[24px] w-[240px]">
            <ngx-scanner-qrcode
              #action="scanner"
              (event)="onData($event, action)"
            ></ngx-scanner-qrcode>
          </div>

          <!-- start -->
          <button
            *ngIf="showCamera"
            (click)="action.isStart ? action.stop() : action.start()"
            class="bg-[#111827] rounded-[10px] flex justify-center items-center w-[240px] py-[10px] px-[24px]"
          >
            <label
              class="text-[14px] font-bold text-white hover:cursor-pointer"
              >{{ action.isStart ? "Dừng lại" : "Tiếp Tục" }}</label
            >
          </button>
        </div>

        <button
          *ngIf="!showCamera"
          (click)="clickStart()"
          class="bg-[#111827] rounded-[10px] flex justify-center items-center w-[240px] py-[10px] px-[24px]"
        >
          <label class="text-[14px] font-bold text-white hover:cursor-pointer">
            Bắt đầu điểm danh
          </label>
        </button>
        <div class="h-[1px] bg-[#F1F2F4] my-[24px]"></div>
        <div>
          <div class="flex justify-between items-center">
            <div *ngIf="editingSV">
              <label class="text-[#687588] text-[12px] font-normal"
                >Ngày bắt đầu</label
              >
              <br />
              <p class="text-[14px]">
                {{ editingSV.ngayBd | date : "dd/MM/yyyy" }}
              </p>
            </div>
            <div>
              <i class="ph ph-caret-right text-[16px] text-[#A0AEC0]"></i>
            </div>
          </div>
          <div class="flex justify-between items-center mt-[16px]">
            <div *ngIf="editingSV">
              <label class="text-[#687588] text-[12px] font-normal"
                >Ngày kết thúc</label
              >
              <br />
              <p class="text-[14px]">
                {{ editingSV.ngayKt | date : "dd/MM/yyyy" }}
              </p>
            </div>
            <div>
              <i class="ph ph-caret-right text-[16px] text-[#A0AEC0]"></i>
            </div>
          </div>
        </div>
      </div>
      <div class="bg-white rounded-[16px] p-[16px]">
        <div
          class="text-sm font-medium text-center text-gray-500 border-b border-gray-200 dark:text-gray-400 dark:border-gray-700"
        >
          <ul class="flex flex-wrap -mb-px">
            <li class="me-2">
              <a
                (click)="btnTG()"
                class="inline-block p-4 border-b-2 text-[#111827] border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 cursor-pointer"
                [ngClass]="{ active: showTG }"
                >Danh sách tham gia</a
              >
            </li>
            <li class="me-2">
              <a
                (click)="btnTT()"
                class="inline-block p-4 border-b-2 text-[#111827] border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 cursor-pointer"
                [ngClass]="{ active: showTT }"
                aria-current="page"
                >Thông tin chương trình</a
              >
            </li>
          </ul>
        </div>
        <div *ngIf="showTG">
          <div class="flex py-[12px] items-center justify-end w-full">
            <div class="relative w-full">
              <div
                class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"
              >
                <i class="ph-bold ph-magnifying-glass text-[20px]"></i>
              </div>
              <input
                type="text"
                [(ngModel)]="searchText"
                name="timBH"
                class="block w-full h-[44px] p-2 pl-10 text-sm border-[#EBEAED] rounded-[10px] text-chung"
                placeholder="Tìm Kiếm"
                required
              />
            </div>

            <div class="flex gap-4 ml-[16px]">
              <div>
                <button
                  (click)="toggleDropDown2()"
                  [ngClass]="{
                    'active-button': activeButton === 'FT Tên',
                    'active-dropdown': filter2
                  }"
                  class="text-black whitespace-nowrap p-2 h-[44px] hover:border-[#29B475] focus:outline-none border-[1px] rounded-[10px] text-[14px] font-medium font-chu2 px-4 py-2.5 text-center inline-flex items-center"
                  type="button"
                >
                  <p class="max-w-[100px] truncate">
                    {{ tbh }}
                  </p>
                  <i class="ph-bold ph-caret-down text-[15px] pl-[5px]"></i>
                </button>

                <!-- Dropdown menu -->
                <div
                  *ngIf="filter2"
                  class="z-10 absolute bg-white divide-y w-[100px] divide-gray-100 rounded-lg shadow dark:bg-gray-700 h-[200px] overflow-y-auto"
                >
                  <ul
                    class="py-2 text-sm text-gray-700 dark:text-gray-200"
                    aria-labelledby="filtertenbh"
                  >
                    <li>
                      <a
                        class="block px-4 py-2 hover:bg-gray-100 font-chu2 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer"
                        (click)="resetFilterNK()"
                      >
                        Tất Cả Lớp
                      </a>
                    </li>
                    <li
                      *ngFor="let lop of dataThamgia | uniqueFilter : 'tenLop'"
                      value="tenLop"
                    >
                      <a
                        (click)="filterNam(lop.tenLop)"
                        class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer font-chu2"
                      >
                        {{ lop.tenLop }}
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="flex gap-4 ml-[16px]">
              <div>
                <button
                  (click)="toggleDropDown1()"
                  [ngClass]="{
                    'active-button': activeButton1 === 'FT VT',
                    'active-dropdown': filter1
                  }"
                  class="text-black whitespace-nowrap p-2 h-[44px] hover:border-[#29B475] focus:outline-none border-[1px] rounded-[10px] text-[14px] font-medium font-chu2 px-4 py-2.5 text-center inline-flex items-center"
                  type="button"
                >
                  <p class="max-w-[100px] truncate">
                    {{ tvaitro }}
                  </p>
                  <i class="ph-bold ph-caret-down text-[15px] pl-[5px]"></i>
                </button>

                <!-- Dropdown menu -->
                <div
                  *ngIf="filter1"
                  class="z-10 absolute bg-white divide-y w-[100px] divide-gray-100 rounded-lg shadow dark:bg-gray-700 h-[200px] overflow-y-auto"
                >
                  <ul
                    class="py-2 text-sm text-gray-700 dark:text-gray-200"
                    aria-labelledby="filtertenvaitro"
                  >
                    <li>
                      <a
                        class="block px-4 py-2 hover:bg-gray-100 font-chu2 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer"
                        (click)="resetFilterVT()"
                      >
                        Tất Cả Vai Trò
                      </a>
                    </li>
                    <li
                      *ngFor="
                        let lop of dataThamgia | uniqueFilter : 'vaiTroThamGia'
                      "
                      value="vaiTroThamGia"
                    >
                      <a
                        (click)="filterVT(lop.vaiTroThamGia)"
                        class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer font-chu2"
                      >
                        {{ lop.vaiTroThamGia }}
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="w-[55vw]">
            <div class="border-[1px] border-[#EDF2F7] rounded-[16px]">
              <table class="w-full">
                <tbody>
                  <tr
                    *ngFor="
                      let diemdanh of dataThamgia
                        | filter : 'tenLop' : bh
                        | filter : 'vaiTroThamGia' : vaitro
                        | search : searchText
                    "
                  >
                    <td class="gap-[16px] p-[16px] mb-[8px] border-none">
                      <div class="flex justify-between">
                        <h4 class="pl-[20px] text-[18px] font-semibold">
                          {{ diemdanh.hoTenSV }}
                        </h4>
                        <div class="flex gap-[10px]">
                          <button
                            (click)="editDD(diemdanh)"
                            class="hover:scale-110 transition-transform border-[1px] border-[#EDF2F7] rounded-[8px]"
                          >
                            <i
                              class="ph-bold ph-pencil-simple text-[#0047BF] p-[8px] text-[14px]"
                            ></i>
                          </button>
                          <button
                            (click)="onDelete(diemdanh.idSinhVien)"
                            class="hover:scale-110 transition-transform border-[1px] border-[#EDF2F7] rounded-[8px]"
                          >
                            <i
                              class="ph-bold ph-trash text-[#E0221F] p-[8px] text-[14px]"
                            ></i>
                          </button>
                        </div>
                      </div>
                      <div class="h-[1px] my-[16px] bg-[#F1F2F4]"></div>
                      <div
                        class="text-[14px] w-full flex flex-wrap justify-between gap-[50px]"
                      >
                        <div>
                          <tr>
                            <td class="font-normal text-[#687588] p-3">
                              Mã SV
                            </td>
                            <td class="font-semibold max-w-[130px] p-3">
                              {{ diemdanh.mssv }}
                            </td>
                          </tr>
                          <tr class="">
                            <td class="font-normal text-[#687588] p-3">
                              Bậc hệ ngành
                            </td>
                            <td
                              class="font-semibold max-w-[200px] truncate p-3"
                            >
                              {{ diemdanh.tenBacHeNganh }}
                            </td>
                          </tr>
                          <tr class="">
                            <td class="font-normal text-[#687588] p-3">
                              Vai trò
                            </td>
                            <td class="font-semibold max-w-[130px] p-3">
                              {{ diemdanh.vaiTroThamGia }}
                            </td>
                          </tr>
                        </div>
                        <div>
                          <tr class="">
                            <td class="font-normal text-[#687588] p-3">Lớp</td>
                            <td class="font-semibold max-w-[130px] p-4">
                              {{ diemdanh.tenLop }}
                            </td>
                          </tr>
                          <tr class="">
                            <td class="font-normal text-[#687588] p-3">
                              Niên Khoá
                            </td>
                            <td class="font-semibold max-w-[130px] p-3">
                              {{ diemdanh.nienKhoa }}
                            </td>
                          </tr>
                          <tr class="">
                            <td class="font-normal text-[#687588] p-3">CVHT</td>
                            <td class="font-semibold max-w-[130px] p-3">
                              {{ diemdanh.hoTenGV }}
                            </td>
                          </tr>
                        </div>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div
                class="flex flex-col items-center font-chu2 pt-[32px] w-[784px]"
                *ngIf="
                  loading && dataThamgia
                    | filter : 'lop' : bh
                    | search : searchText
                "
              >
                <img
                  src="../../../../assets/empty1.png"
                  class="w-[87px] h-[87px]"
                />

                <h1 class="text-[#718096] text-[18px] font-bold pt-[16px]">
                  Dữ liệu trống
                </h1>
                <p class="text-[14px] font-normal text-[#A0AEC0]">
                  Chưa có dữ liệu điểm danh
                </p>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="showTT" class="pt-[12px]">
          <div class="flex justify-between" *ngIf="editingSV">
            <div class="w-[27.5vw]">
              <table class="w-full font-[Manrope] text-[14px] border-0">
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Mã hoạt động
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{ editingSV.maHdnk }}
                  </td>
                </tr>
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Tên hoạt động
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{ editingSV.tenHdnk }}
                  </td>
                </tr>
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Kỹ năng hoạt động
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{ editingSV.kyNangHDNK }}
                  </td>
                </tr>
              </table>
            </div>
            <div class="w-[27.5vw]">
              <table class="w-full font-[Manrope] text-[14px] border-0">
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Nội dung minh chứng
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{
                      editingSV.noiDungMinhChung !== null
                        ? editingSV.noiDungMinhChung
                        : "Trống"
                    }}
                  </td>
                </tr>
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Điểm
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{ editingSV.diemHdnk }}
                  </td>
                </tr>
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Địa điểm
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{ editingSV.tenDiaDiem }}
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="showResult">
    <div class="flex items-center pb-[24px] flex-wrap" *ngIf="editingSV">
      <button (click)="clickCloseRe()">
        <i
          class="ph-bold ph-caret-left text-[20px] pr-[8px] text-[#A0AEC0]"
        ></i>
      </button>
      <h1 class="text-[20px] font-bold">{{ editingSV.tenHdnk }}</h1>
    </div>
    <div class="flex gap-[24px]">
      <div class="bg-white rounded-[16px] p-[16px] max-h-[520px]">
        <h3 class="text-[20px] font-bold text-center">Tổng Kết</h3>
        <div class="h-[1px] bg-[#F1F2F4] my-[12px]"></div>
        <div>
          <div class="flex justify-between items-center">
            <div *ngIf="editingSV">
              <label class="text-[#687588] text-[12px] font-normal"
                >Ngày bắt đầu</label
              >
              <br />
              <p class="text-[14px]">
                {{ editingSV.ngayBd | date : "dd/MM/yyyy" }}
              </p>
            </div>
            <div>
              <i class="ph ph-caret-right text-[16px] text-[#A0AEC0]"></i>
            </div>
          </div>
          <div class="flex justify-between items-center mt-[16px]">
            <div *ngIf="editingSV">
              <label class="text-[#687588] text-[12px] font-normal"
                >Ngày kết thúc</label
              >
              <br />
              <p class="text-[14px]">
                {{ editingSV.ngayKt | date : "dd/MM/yyyy" }}
              </p>
            </div>
            <div>
              <i class="ph ph-caret-right text-[16px] text-[#A0AEC0]"></i>
            </div>
          </div>
        </div>
        <div class="h-[1px] bg-[#F1F2F4] my-[12px]"></div>
        <div>
          <div>
            <label class="text-[#687588] text-[12px] font-normal"
              >Tổng số SV tham dự</label
            >
            <br />
            <p class="text-[14px]">{{ slsv }}</p>
          </div>
          <div class="mt-[16px]">
            <label class="text-[#687588] text-[12px] font-normal"
              >Tổng số SV là BTC</label
            >
            <br />
            <p class="text-[14px]">0</p>
          </div>
          <div class="mt-[16px]">
            <label class="text-[#687588] text-[12px] font-normal"
              >Tổng số SV không tham gia</label
            >
            <br />
            <p class="text-[14px]">0</p>
          </div>
        </div>
        <div class="h-[1px] bg-[#F1F2F4] my-[12px]"></div>
        <button
          (click)="exportToExcel()"
          class="bg-[#111827] rounded-[10px] flex justify-center items-center w-[240px] py-[10px] px-[24px] gap-[8px] cursor-pointer"
        >
          <i
            class="ph ph-file-arrow-down text-[16px] text-white cursor-pointer"
          ></i>
          <label class="text-[14px] font-bold text-white cursor-pointer">
            Tải danh sách tham gia
          </label>
        </button>
      </div>
      <div class="bg-white rounded-[16px] p-[16px]">
        <div
          class="text-sm font-medium text-center text-gray-500 border-b border-gray-200 dark:text-gray-400 dark:border-gray-700"
        >
          <ul class="flex flex-wrap -mb-px">
            <li class="me-2">
              <a
                (click)="btnTGR()"
                class="inline-block p-4 border-b-2 text-[#111827] border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 cursor-pointer"
                [ngClass]="{ active: showTGR }"
                >Danh sách tham gia</a
              >
            </li>
            <li class="me-2">
              <a
                (click)="btnTTR()"
                class="inline-block p-4 border-b-2 text-[#111827] border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 cursor-pointer"
                [ngClass]="{ active: showTTR }"
                aria-current="page"
                >Thông tin chương trình</a
              >
            </li>
          </ul>
        </div>
        <div *ngIf="showTGR">
          <div class="flex py-[12px] items-center justify-end w-full">
            <div class="relative w-full">
              <div
                class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"
              >
                <i class="ph-bold ph-magnifying-glass text-[20px]"></i>
              </div>
              <input
                type="text"
                [(ngModel)]="searchText"
                name="timBH"
                class="block w-full h-[44px] p-2 pl-10 text-sm border-[#EBEAED] rounded-[10px] text-chung"
                placeholder="Tìm Kiếm"
                required
              />
            </div>

            <div class="flex gap-4 ml-[16px]">
              <div>
                <button
                  (click)="toggleDropDown2()"
                  [ngClass]="{
                    'active-button': activeButton === 'FT Tên',
                    'active-dropdown': filter2
                  }"
                  class="text-black whitespace-nowrap p-2 h-[44px] hover:border-[#29B475] focus:outline-none border-[1px] rounded-[10px] text-[14px] font-medium font-chu2 px-4 py-2.5 text-center inline-flex items-center"
                  type="button"
                >
                  <p class="max-w-[100px] truncate">
                    {{ tbh }}
                  </p>
                  <i class="ph-bold ph-caret-down text-[15px] pl-[5px]"></i>
                </button>

                <!-- Dropdown menu -->
                <div
                  *ngIf="filter2"
                  class="z-10 absolute bg-white divide-y w-[100px] divide-gray-100 rounded-lg shadow dark:bg-gray-700 h-[200px] overflow-y-auto"
                >
                  <ul
                    class="py-2 text-sm text-gray-700 dark:text-gray-200"
                    aria-labelledby="filtertenbh"
                  >
                    <li>
                      <a
                        class="block px-4 py-2 hover:bg-gray-100 font-chu2 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer"
                        (click)="resetFilterNK()"
                      >
                        Tất Cả Lớp
                      </a>
                    </li>
                    <li
                      *ngFor="let lop of dataThamgia | uniqueFilter : 'tenLop'"
                      value="tenLop"
                    >
                      <a
                        (click)="filterNam(lop.tenLop)"
                        class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer font-chu2"
                      >
                        {{ lop.tenLop }}
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="flex gap-4 ml-[16px]">
              <div>
                <button
                  (click)="toggleDropDown1()"
                  [ngClass]="{
                    'active-button': activeButton1 === 'FT VT',
                    'active-dropdown': filter1
                  }"
                  class="text-black whitespace-nowrap p-2 h-[44px] hover:border-[#29B475] focus:outline-none border-[1px] rounded-[10px] text-[14px] font-medium font-chu2 px-4 py-2.5 text-center inline-flex items-center"
                  type="button"
                >
                  <p class="max-w-[100px] truncate">
                    {{ tvaitro }}
                  </p>
                  <i class="ph-bold ph-caret-down text-[15px] pl-[5px]"></i>
                </button>

                <!-- Dropdown menu -->
                <div
                  *ngIf="filter1"
                  class="z-10 absolute bg-white divide-y w-[100px] divide-gray-100 rounded-lg shadow dark:bg-gray-700 h-[200px] overflow-y-auto"
                >
                  <ul
                    class="py-2 text-sm text-gray-700 dark:text-gray-200"
                    aria-labelledby="filtertenvaitro"
                  >
                    <li>
                      <a
                        class="block px-4 py-2 hover:bg-gray-100 font-chu2 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer"
                        (click)="resetFilterVT()"
                      >
                        Tất Cả Vai Trò
                      </a>
                    </li>
                    <li
                      *ngFor="
                        let lop of dataThamgia | uniqueFilter : 'vaiTroThamGia'
                      "
                      value="vaiTroThamGia"
                    >
                      <a
                        (click)="filterVT(lop.vaiTroThamGia)"
                        class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer font-chu2"
                      >
                        {{ lop.vaiTroThamGia }}
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="w-[55vw]">
            <div class="border-[1px] border-[#EDF2F7] rounded-[16px]">
              <table class="w-full">
                <tbody>
                  <tr
                    *ngFor="
                      let diemdanh of dataResult
                        | filter : 'tenLop' : bh
                        | filter : 'vaiTroThamGia' : vaitro
                        | search : searchText
                    "
                  >
                    <td class="gap-[16px] p-[16px] mb-[8px] border-none">
                      <div class="flex justify-between">
                        <h4 class="pl-[20px] text-[18px] font-semibold">
                          {{ diemdanh.hoTenSV }}
                        </h4>
                      </div>
                      <div class="h-[1px] my-[16px] bg-[#F1F2F4]"></div>
                      <div
                        class="text-[14px] w-full flex flex-wrap justify-between gap-[50px]"
                      >
                        <div>
                          <tr>
                            <td class="font-normal text-[#687588] p-3">
                              Mã SV
                            </td>
                            <td class="font-semibold max-w-[130px] p-3">
                              {{ diemdanh.mssv }}
                            </td>
                          </tr>
                          <tr class="">
                            <td class="font-normal text-[#687588] p-3">
                              Bậc hệ ngành
                            </td>
                            <td
                              class="font-semibold max-w-[200px] truncate p-3"
                            >
                              {{ diemdanh.tenBacHeNganh }}
                            </td>
                          </tr>
                          <tr class="">
                            <td class="font-normal text-[#687588] p-3">
                              Vai trò
                            </td>
                            <td class="font-semibold max-w-[130px] p-3">
                              {{ diemdanh.vaiTroThamGia }}
                            </td>
                          </tr>
                        </div>
                        <div>
                          <tr class="">
                            <td class="font-normal text-[#687588] p-3">Lớp</td>
                            <td class="font-semibold max-w-[130px] p-4">
                              {{ diemdanh.tenLop }}
                            </td>
                          </tr>
                          <tr class="">
                            <td class="font-normal text-[#687588] p-3">
                              Niên Khoá
                            </td>
                            <td class="font-semibold max-w-[130px] p-3">
                              {{ diemdanh.nienKhoa }}
                            </td>
                          </tr>
                          <tr class="">
                            <td class="font-normal text-[#687588] p-3">CVHT</td>
                            <td class="font-semibold max-w-[130px] p-3">
                              {{ diemdanh.hoTenGV }}
                            </td>
                          </tr>
                        </div>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div
                class="flex flex-col items-center font-chu2 pt-[32px] w-[784px]"
                *ngIf="
                  loading && dataThamgia
                    | filter : 'lop' : bh
                    | search : searchText
                "
              >
                <img
                  src="../../../../assets/empty1.png"
                  class="w-[87px] h-[87px]"
                />

                <h1 class="text-[#718096] text-[18px] font-bold pt-[16px]">
                  Dữ liệu trống
                </h1>
                <p class="text-[14px] font-normal text-[#A0AEC0]">
                  Chưa có dữ liệu điểm danh
                </p>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="showTTR" class="pt-[12px]">
          <div class="flex justify-between" *ngIf="editingSV">
            <div class="w-[27.5vw]">
              <table class="w-full font-[Manrope] text-[14px] border-0">
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Mã hoạt động
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{ editingSV.maHdnk }}
                  </td>
                </tr>
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Tên hoạt động
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{ editingSV.tenHdnk }}
                  </td>
                </tr>
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Kỹ năng hoạt động
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{ editingSV.kyNangHDNK }}
                  </td>
                </tr>
              </table>
            </div>
            <div class="w-[27.5vw]">
              <table class="w-full font-[Manrope] text-[14px] border-0">
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Nội dung minh chứng
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{
                      editingSV.noiDungMinhChung !== null
                        ? editingSV.noiDungMinhChung
                        : "Trống"
                    }}
                  </td>
                </tr>
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Điểm
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{ editingSV.diemHdnk }}
                  </td>
                </tr>
                <tr>
                  <td class="text-[#687588] font-normal p-4 border-none">
                    Địa điểm
                  </td>
                  <td class="text-[#111827] font-semibold p-4 border-none">
                    {{ editingSV.tenDiaDiem }}
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- <div class="w-[250px] h-[250px] pl-[10px]">
  <canvas id="ctx"></canvas>
</div> -->

<!-- popup edit -->
<div
  *ngIf="showModalEdit"
  class="fixed top-0 left-0 right-0 z-50 w-full p-4 overflow-x-hidden overflow-y-auto h-screen max-h-full bg-gray-800 bg-opacity-50 flex items-center justify-center"
>
  <div class="w-[500px] bg-white shadow-2xl p-[24px] rounded-[16px]">
    <div class="grid grid-cols-1 grid-row-start-1 gap-2.5">
      <div class="flex w-full justify-between pb-6">
        <h1 class="text-[18px] font-semibold leading-6">
          Cập Nhật Thông Tin Sinh Viên
        </h1>
      </div>
    </div>
    <div class="flex">
      <div>
        <div class="pb-4">
          <label class="pb-3 font-chu2 text-[14px] leading-6 font-medium"
            >Mã Sinh Viên</label
          >
          <input
            *ngIf="editingLop"
            class="w-full h-[44px] px-[20px] py-[11px] border-[1px] rounded-[10px] border-[#E9EAEC] font-normal text-[14px] mt-[5px] cursor-not-allowed"
            placeholder="15"
            [(ngModel)]="editingLop.mssv"
            disabled
          />
        </div>
        <div class="pb-4">
          <label class="pb-3 font-chu2 text-[14px] leading-6 font-medium"
            >Họ Tên Sinh Viên</label
          >

          <input
            *ngIf="editingLop"
            class="w-full h-[44px] px-[20px] py-[11px] border-[1px] rounded-[10px] border-[#E9EAEC] font-normal text-[14px] mt-[5px] cursor-not-allowed"
            placeholder="15"
            [(ngModel)]="editingLop.hoTenSV"
            disabled
          />
        </div>
        <div class="pb-4">
          <label class="pb-3 font-chu2 text-[14px] leading-6 font-medium"
            >Bậc Hệ Ngành</label
          >
          <input
            *ngIf="editingLop"
            class="w-full h-[44px] px-[20px] py-[11px] border-[1px] rounded-[10px] border-[#E9EAEC] font-normal text-[14px] mt-[5px] cursor-not-allowed"
            placeholder="15"
            [(ngModel)]="editingLop.tenBacHeNganh"
            disabled
          />
        </div>

        <div class="pb-4">
          <label class="pb-3 font-chu2 text-[14px] leading-6 font-medium"
            >Lớp</label
          >
          <input
            *ngIf="editingLop"
            class="w-full h-[44px] px-[20px] py-[11px] border-[1px] rounded-[10px] border-[#E9EAEC] font-normal text-[14px] mt-[5px] cursor-not-allowed"
            placeholder="15"
            [(ngModel)]="editingLop.tenLop"
            disabled
          />
        </div>
      </div>
      <div class="pl-[30px]">
        <div class="pb-4">
          <label class="pb-3 font-chu2 text-[14px] leading-6 font-medium"
            >Niên Khoá</label
          >
          <input
            *ngIf="editingLop"
            class="w-full h-[44px] px-[20px] py-[11px] border-[1px] rounded-[10px] border-[#E9EAEC] font-normal text-[14px] mt-[5px] cursor-not-allowed"
            placeholder="15"
            [(ngModel)]="editingLop.nienKhoa"
            disabled
          />
        </div>
        <div class="pb-4">
          <label class="pb-3 font-chu2 text-[14px] leading-6 font-medium"
            >Cố Vấn Học Tập</label
          >
          <input
            *ngIf="editingLop"
            class="w-full h-[44px] px-[20px] py-[11px] border-[1px] rounded-[10px] border-[#E9EAEC] font-normal text-[14px] mt-[5px] cursor-not-allowed"
            placeholder="15"
            [(ngModel)]="editingLop.hoTenGV"
            disabled
          />
        </div>
        <div class="pb-4">
          <label class="pb-3 font-chu2 text-[14px] leading-6 font-medium"
            >Vai Trò Tham Gia</label
          >
          <input
            *ngIf="editingLop"
            class="w-full h-[44px] px-[20px] py-[11px] border-[1px] rounded-[10px] border-[#E9EAEC] font-normal text-[14px] mt-[5px]"
            placeholder="15"
            [(ngModel)]="editingLop.vaiTroThamGia"
          />
        </div>
      </div>
    </div>
    <div class="grid grid-cols-1 grid-row-start-4 pt-4 w-full gap-4">
      <div class="text-end pt-1 flex justify-end">
        <button
          (click)="closeModaledit()"
          class="flex-1 py-[11px] font-chu2 rounded-[10px] border-[1px] hover:bg-[#F8F8F8] hover:border-[#F8F8F8] text-[#00000] border-black items-center transition-all"
        >
          <h1 class="text-[16px] leading-6 font-chu3 font-normal">Hủy</h1>
        </button>
        <button
          (click)="updateDD()"
          class="flex-[2] py-[11px] ml-[20px] rounded-[10px] items-center transition-all bg-[#29B475]"
        >
          <h1 class="text-[16px] leading-6 text-white font-chu2 font-semibold">
            Cập Nhật
          </h1>
        </button>
      </div>
    </div>
  </div>
</div>

<div
  *ngIf="ondelete"
  class="fixed top-0 left-0 right-0 z-50 w-full p-4 overflow-x-hidden overflow-y-auto h-screen max-h-full bg-gray-800 bg-opacity-50 flex items-center justify-center"
>
  <div class="py-[24px] px-[24px] w-[400px] h-[260px] bg-white rounded-xl">
    <div class="flex justify-between items-center mb-[16px]">
      <div>
        <img src="../../../../assets/trash.png" class="w-[60px] h-[60px]" />
      </div>
      <button (click)="closeDelete()">
        <img
          src="../../../../assets/x-close.png"
          class="w-[24px] h-[24px] cursor-pointer transform hover:scale-110 transition-transform"
        />
      </button>
    </div>
    <div class="mb-[32px]">
      <h1 class="font-chu2 text-[18px] font-semibold">Bạn đang xoá dữ liệu</h1>
      <p
        class="font-chu2 text-[14px] leading-[20px] font-normal text-[#475467]"
      >
        Bằng việc nhấn nút “Xoá”, hệ thống sẽ xoá dữ liệu theo bạn yêu cầu và
        không thể khôi phục lại dữ liệu.
      </p>
    </div>
    <div class="flex gap-[12px]">
      <div class="w-[50%]">
        <button
          (click)="closeDelete()"
          class="flex w-full py-[10px] px-[18px] justify-center items-center rounded-lg border-[1px] border-[#D0D5DD] cursor-pointer hover:bg-slate-400 hover:text-[#ffff]"
        >
          <label
            class="font-chu2 text-btn font-normal leading-[24px] cursor-pointer"
            >Huỷ</label
          >
        </button>
      </div>
      <div class="w-[50%]">
        <button
          (click)="deleteBH()"
          class="flex w-full py-[10px] px-[18px] button-addkhoa justify-center items-center rounded-lg border-[1px] border-[#D92D20] bg-[#D92D20] text-[#ffff] hover:bg-red-500 cursor-pointer"
        >
          <label
            class="font-chu2 text-btn font-semibold leading-[24px] cursor-pointer"
            >Xoá Dữ Liệu</label
          >
        </button>
      </div>
    </div>
  </div>
</div>
